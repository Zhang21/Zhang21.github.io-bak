# 正则表达式



参考：

- 《鸟哥的Linux私房菜》
- [正则表达式维基百科](https://zh.wikipedia.org/wiki/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F)




<br>
<br>

<!--more-->

<br/>



# 正则表达式介绍



正则表达式，又称正规表示式、正规表示法、正规表达式、规则表达式、常规表示法(Regular Expression, 在代码中常简写为regex、regexp或RE）。
是计算机科学的一个概念。正则表达式使用单个字符串来描述、匹配一系列匹配某个句法规则的字符串。在很多文本编辑器里，正则表达式通常被用来检索、替换那些匹配某个模式的文本。

<br/>

正则表达式的POSIX规范，分为两大流派：

- 基本型正则表达式（Basic Regular Expression，BRE）
	+ `grep`、`vi`、`sed`都属于BRE，是历史最早的正则表达式，因此元字符必须转译之后才具有特殊含义
- 扩展型正则表达式（Extended Regular Express，ERE）
	+ `egrep`、`awk`则属于ERE，元字符不用转译



<br>
<br>

---

<br/>


# 正则表达式基本语法


一个正则表达式通常被称为一个模式（pattern），用来描述或者匹配一系列匹配某个句法规则的字符串。

<br>

大部分正则表达式有如下结构：

- **选择**
	+ `|`竖线符代表选择(或)，具有最低优先级
- **数量限定**
	+ 字符后的数量限定符用来限定前面这个字符允许出现的个数
	+ 不加数量限定则代表仅出现一次
	+ 常见的数量限定符包括 **+**、**?**、**\***
		* `+`加号代表前面的字符必须至少出现一次 ( $$$>=1$$$ )
		* `?`问号代表前面的字符最多只可出现一次 ( $$$1>=?>=0$$$ )
		* `*`星号代表前面的字符可不出现，也可出现一次或多次 ($$$>=0$$$)
- **匹配**
	+ `()`圆括号可以定义操作符的范围和优先度



<br/>
<br/>

---

<br>



# PCRE表达式全集



正则表达式有多种不同的风格。
PCRE（Perl兼容正则表达式，Perl Compatible Regular Expression）。适用于Perl或者Python编程语言（grep或者egrep的正则表达式文法是PCRE的子集）

<br/>

**基础正则表达式**

字符 | 描述
- | -
\ | 转义字符
zhang | 匹配文本字符串值`zhang`
. | 匹配除`\r`,`\n`之外的任何单个字符
竖线l | 匹配竖线两边某一个
^ | 匹配输入字符串的开始位置
$ | 匹配输入字符串的结束位置
* | 匹配前面的子表达式零次或多次
+ | 匹配前面的子表达式一次或多次
? | 匹配前面的子表达式零次或一次
{n} | n是一个非负整数。匹配n次
{n,} | n是一个非负整数。至少匹配n次
{n,m} | m和n均为非负整数，匹配n-m次
[xyz] | 字符集合（character class）。匹配所包含的任意一个字符
[^xyz] | 排除型字符集合（negated character classes）。匹配未列出的任意字符
[a-z] | 字符范围。匹配指定范围内的任意字符
[^a-z] | 排除型的字符范围。匹配任何不在指定范围内的任意字符
[:name:] | 增加命名字符类（named character class）
[=elt=] | 增加当前locale下排序（collate）等价于字符“elt”的元素
[.elt.] | 增加排序元素（collation element）elt到表达式中。这是因为某些排序元素由多个字符组成


<br>

**元字符**
元字符(meta character)，是一种Perl风格的正则表达式，只有一部分文本处理工具支持它。

字符 | 描述
- | -
\b | 匹配一个单词边界，也就是指单词和空格间的位置
\B | 匹配非单词边界。“er\B”能匹配“verb”中的“er”，但不能匹配“never”中的“er”
\cx | 匹配由x指明的控制字符
\d | 匹配一个数字字符。等价于[0-9]。注意Unicode正则表达式会匹配全角数字字符
\D | 匹配一个非数字字符。等价于[^0-9]
\f | 匹配一个换页符。等价于\x0c和\cL
\n | 匹配一个换行符。等价于\x0a和\cJ
\r | 匹配一个回车符。等价于\x0d和\cM
\s | 匹配任何空白字符，包括空格、制表符、换页符等等
\S | 匹配任何非空白字符。等价于[^ \f\n\r\t\v]
\t | 匹配一个制表符。等价于\x09和\cI
\v | 匹配一个垂直制表符。等价于\x0b和\cK
\w | 匹配包括下划线的任何单词字符。等价于“[A-Za-z0-9_]”。注意Unicode正则表达式会匹配中文字符
\W | 匹配任何非单词字符。等价于“[^A-Za-z0-9_]”
\ck | 匹配控制转义字符。k代表一个字符。等价于“Ctrl-k”。用于ECMA语法
\xnn | 十六进制转义字符序列。匹配两个十六进制数字nn表示的字符
\num | 向后引用（back-reference）一个子字符串（substring），该子字符串与正则表达式的第num个用括号围起来的捕捉群（capture group）子表达式（subexpression）匹配。其中num是从1开始的十进制正整数，其上限可能是9[注 2]、31、[注 3]99甚至无限。[注 4]例如：“(.)\1”匹配两个连续的相同字符
\n | 标识一个八进制转义值或一个向后引用。如果\n之前至少n个获取的子表达式，则n为向后引用。否则，如果n为八进制数字（0-7），则n为一个八进制转义值
\nm | 3位八进制数字，标识一个八进制转义值或一个向后引用。如果\nm之前至少有nm个获得子表达式，则nm为向后引用。如果\nm之前至少有n个获取，则n为一个后跟文字m的向后引用。如果前面的条件都不满足，若n和m均为八进制数字（0-7），则\nm将匹配八进制转义值nm
\nml | 如果n为八进制数字（0-3），且m和l均为八进制数字（0-7），则匹配八进制转义值nml
\un | Unicode转义字符序列。其中n是一个用四个十六进制数字表示的Unicode字符


<br/>


**扩展正则表达式**

字符 | 描述
- | -
? | 非贪心量化（Non-greedy quantifiers）：当该字符紧跟在任何一个其他重复修饰符（*,+,?，{n}，{n,}，{n,m}）后面时，匹配模式是非贪婪的。非贪婪模式尽可能少的匹配所搜索的字符串，而默认的贪婪模式则尽可能多的匹配所搜索的字符串
(pattern) | 匹配pattern并获取这一匹配的子字符串。该子字符串用于向后引用。所获取的匹配可以从产生的Matches集合得到，在VBScript中使用SubMatches集合，在JScript中则使用$0…$9属性。要匹配圆括号字符，请使用“\(”或“\)”
(?:pattern) | 匹配pattern但不获取匹配的子字符串（shy groups)，也就是说这是一个非获取匹配，不存储匹配的子字符串用于向后引用
(?=pattern) | 正向肯定预查（look ahead positive assert），在任何匹配pattern的字符串开始处匹配查找字符串。这是一个非获取匹配，也就是说，该匹配不需要获取供以后使用
(?!pattern) | 正向否定预查(negative assert)，在任何不匹配pattern的字符串开始处匹配查找字符串。这是一个非获取匹配，也就是说，该匹配不需要获取供以后使用
(?<=pattern) | 反向(look behind)肯定预查，与正向肯定预查类似，只是方向相反
(?<!pattern) | 反向否定预查，与正向否定预查类似，只是方向相反



<br/>
<br/>

---

<br>



# POSIX字符组




POSIX字符类(POSIX character class),是一个形如[:…:]的特殊元序列，它用于匹配特定的字符范围。

POSIX字符组 | 说明 | ASCII环境 | Unicode环境
- | -
[:alnum:] | 字母字符和数字字符 | [a-zA-Z0-9] | [\p{L&}\p{Nd}]
[:alpha:] | 字母 | [a-zA-Z] | \p{L&}
[:ascii:] | ASCII字符 | [\x00-\x7F] | \p{InBasicLatin}
[:blank:] | 空格字符和制表符 | [ \t] | [\p{Zs}\t]
[:cntrl:] | 控制字符 | [\x00-\x1F\x7F] | \p{Cc}
[:digit:] | 数字字符 | [0-9] | \p{Nd}
[:graph:] | 空白字符之外的字符 | [\x21-\x7E] | [^\p{Z}\p{C}]
[:lower:] | 小写字母字符 | [a-z] | \p{Ll}
[:print:] | 类似[:graph:]，但包括空白字符 | [\x20-\x7E] | \P{C}
[:punct:] | 标点符号 | }~-] | [\p{P}\p{S}]
[:space:] | 空白字符 | [ \t\r\n\v\f] | [\p{Z}\t\r\n\v\f]
[:upper:] | 大写字母字符 | [A-Z] | \p{Lu}
[:word:] | 字母字符 | [A-Za-z0-9_] | [\p{L}\p{N}\p{Pc}]
[:xdigit:] | 十六进制字符 | [A-Fa-f0-9] | [A-Fa-f0-9]



<br>
<br>

---

<br/>



# 优先级



优先权 | 符号
- | -
最高 | \
高 | ( )、(?: )、(?= )、[ ]
中 | *、+、?、{n}、{n,}、{m,n}
低 | ^、$、中介字符
次最低 | 串接，即相邻字符连接在一起
最低 | l




































